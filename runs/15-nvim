#!/usr/bin/env bash

set -euo pipefail

log() {
    echo "[NVIM] $1"
}

DOTFILES_DIR="${DEV_ENV:-$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)}"

log "Setting up Neovim configuration..."

# Update nvim submodule
log "Updating nvim submodule..."
cd "$DOTFILES_DIR"
git submodule update --init --remote dotfiles/nvim

# Remove existing nvim config
if [ -e "$HOME/.config/nvim" ] || [ -L "$HOME/.config/nvim" ]; then
    log "Removing existing nvim config..."
    rm -rf "$HOME/.config/nvim"
fi

# Create symlink to nvim config
log "Creating symlink to nvim config..."
ln -sf "$DOTFILES_DIR/dotfiles/nvim" "$HOME/.config/nvim"

log "Neovim configuration complete!"
