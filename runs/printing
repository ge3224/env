#!/usr/bin/env bash

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$SCRIPT_DIR/_common.sh"

echo "Setting up CUPS printing system..."

echo "Installing CUPS..."
install_packages \
    cups \
    cups-pdf \
    system-config-printer \
    ghostscript \
    gsfonts

echo "Installing printer drivers..."
install_packages \
    gutenprint \
    hplip \
    splix

echo "Enabling CUPS service..."
sudo systemctl enable --now cups.service

echo "Adding $USER to lp group..."
sudo usermod -aG lp "$USER"

echo "CUPS printing system installed!"
echo "Note: You may need to log out and back in for group changes to take effect"
echo "Configure printers at http://localhost:631 or use system-config-printer"
