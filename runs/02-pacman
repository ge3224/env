#!/usr/bin/env bash

set -euo pipefail

log() {
    echo "[PACMAN] $1"
}

log "Configuring pacman..."

# Enable colorized output and verbose package lists
log "Enabling pacman color and verbose output..."
sudo sed -i 's/^#Color$/Color/' /etc/pacman.conf
sudo sed -i 's/^#VerbosePkgLists$/VerbosePkgLists/' /etc/pacman.conf

# Enable multilib repository
log "Enabling multilib repository..."
sudo sed -i '/^#\[multilib\]$/,/^#Include = \/etc\/pacman.d\/mirrorlist$/ {
    s/^#\[multilib\]$/[multilib]/
    s/^#Include = \/etc\/pacman.d\/mirrorlist$/Include = \/etc\/pacman.d\/mirrorlist/
}' /etc/pacman.conf

# Run system update
log "Running system update..."
sudo pacman -Syu --noconfirm

log "Pacman configuration complete!"
